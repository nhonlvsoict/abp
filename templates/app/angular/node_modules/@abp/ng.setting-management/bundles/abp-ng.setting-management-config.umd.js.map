{"version":3,"file":"abp-ng.setting-management-config.umd.js","sources":["../../../packages/setting-management/config/src/providers/route.provider.ts","../../../packages/setting-management/config/src/proxy/email-settings.service.ts","../../../packages/setting-management/config/src/components/email-setting-group/email-setting-group.component.ts","../../../packages/setting-management/config/src/providers/setting-tab.provider.ts","../../../packages/setting-management/config/src/setting-management-config.module.ts","../../../packages/setting-management/config/src/abp-ng.setting-management-config.ts"],"sourcesContent":["import { eLayoutType, RoutesService, SettingTabsService } from '@abp/ng.core';\nimport { eThemeSharedRouteNames } from '@abp/ng.theme.shared';\nimport { APP_INITIALIZER } from '@angular/core';\nimport { debounceTime, map } from 'rxjs/operators';\nimport { eSettingManagementRouteNames } from '../enums/route-names';\n\nexport const SETTING_MANAGEMENT_ROUTE_PROVIDERS = [\n  { provide: APP_INITIALIZER, useFactory: configureRoutes, deps: [RoutesService], multi: true },\n  {\n    provide: APP_INITIALIZER,\n    useFactory: hideRoutes,\n    deps: [RoutesService, SettingTabsService],\n    multi: true,\n  },\n];\n\nexport function configureRoutes(routesService: RoutesService) {\n  return () => {\n    routesService.add([\n      {\n        name: eSettingManagementRouteNames.Settings,\n        path: '/setting-management',\n        parentName: eThemeSharedRouteNames.Administration,\n        layout: eLayoutType.application,\n        order: 100,\n        iconClass: 'fa fa-cog',\n      },\n    ]);\n  };\n}\n\nexport function hideRoutes(routesService: RoutesService, settingTabsService: SettingTabsService) {\n  return () => {\n    settingTabsService.visible$\n      .pipe(\n        debounceTime(0),\n        map(nodes => !nodes.length),\n      )\n      .subscribe(invisible =>\n        routesService.patch(eSettingManagementRouteNames.Settings, { invisible }),\n      );\n  };\n}\n","import type { EmailSettingsDto, UpdateEmailSettingsDto } from './models';\nimport { RestService } from '@abp/ng.core';\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class EmailSettingsService {\n  apiName = 'SettingManagement';\n\n  get = () =>\n    this.restService.request<any, EmailSettingsDto>({\n      method: 'GET',\n      url: '/api/setting-management/emailing',\n    },\n    { apiName: this.apiName });\n\n  update = (input: UpdateEmailSettingsDto) =>\n    this.restService.request<any, void>({\n      method: 'POST',\n      url: '/api/setting-management/emailing',\n      body: input,\n    },\n    { apiName: this.apiName });\n\n  constructor(private restService: RestService) {}\n}\n","import { collapse, ToasterService } from '@abp/ng.theme.shared';\nimport { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { finalize } from 'rxjs/operators';\nimport { EmailSettingsService } from '../../proxy/email-settings.service';\nimport { EmailSettingsDto } from '../../proxy/models';\n\n@Component({\n  selector: 'abp-email-setting-group',\n  templateUrl: 'email-setting-group.component.html',\n  animations: [collapse],\n})\nexport class EmailSettingGroupComponent implements OnInit {\n  form: FormGroup;\n\n  saving = false;\n\n  constructor(\n    private emailSettingsService: EmailSettingsService,\n    private fb: FormBuilder,\n    private toasterService: ToasterService,\n  ) {}\n\n  ngOnInit() {\n    this.getData();\n  }\n\n  private getData() {\n    this.emailSettingsService.get().subscribe(res => {\n      this.buildForm(res);\n    });\n  }\n\n  private buildForm(emailSettings: EmailSettingsDto) {\n    this.form = this.fb.group({\n      defaultFromDisplayName: [emailSettings.defaultFromDisplayName, [Validators.required]],\n      defaultFromAddress: [emailSettings.defaultFromAddress, [Validators.required]],\n      smtpHost: [emailSettings.smtpHost],\n      smtpPort: [emailSettings.smtpPort, [Validators.required]],\n      smtpEnableSsl: [emailSettings.smtpEnableSsl],\n      smtpUseDefaultCredentials: [emailSettings.smtpUseDefaultCredentials],\n      smtpDomain: [emailSettings.smtpDomain],\n      smtpUserName: [emailSettings.smtpUserName],\n      smtpPassword: [emailSettings.smtpPassword],\n    });\n  }\n\n  submit() {\n    if (this.saving || this.form.invalid) return;\n\n    this.saving = true;\n    this.emailSettingsService\n      .update(this.form.value)\n      .pipe(finalize(() => (this.saving = false)))\n      .subscribe(() => {\n        this.toasterService.success('AbpSettingManagement::SuccessfullySaved');\n        this.getData();\n      });\n  }\n}\n","import { SettingTabsService } from '@abp/ng.core';\nimport { APP_INITIALIZER } from '@angular/core';\nimport { EmailSettingGroupComponent } from '../components/email-setting-group/email-setting-group.component';\nimport { eSettingManamagementSettingTabNames } from '../enums/setting-tab-names';\n\nexport const SETTING_MANAGEMENT_SETTING_TAB_PROVIDERS = [\n  {\n    provide: APP_INITIALIZER,\n    useFactory: configureSettingTabs,\n    deps: [SettingTabsService],\n    multi: true,\n  },\n];\n\nexport function configureSettingTabs(settingTabs: SettingTabsService) {\n  return () => {\n    settingTabs.add([\n      {\n        name: eSettingManamagementSettingTabNames.EmailSettingGroup,\n        order: 100,\n        requiredPolicy: 'SettingManagement.Emailing',\n        component: EmailSettingGroupComponent,\n      },\n    ]);\n  };\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { CoreModule } from '@abp/ng.core';\nimport { EmailSettingGroupComponent } from './components/email-setting-group/email-setting-group.component';\nimport { SETTING_MANAGEMENT_ROUTE_PROVIDERS } from './providers/route.provider';\nimport { SETTING_MANAGEMENT_SETTING_TAB_PROVIDERS } from './providers/setting-tab.provider';\nimport { NgxValidateCoreModule } from '@ngx-validate/core';\n\n@NgModule({\n  imports: [CoreModule, NgxValidateCoreModule],\n  declarations: [EmailSettingGroupComponent],\n  exports: [EmailSettingGroupComponent],\n})\nexport class SettingManagementConfigModule {\n  static forRoot(): ModuleWithProviders<SettingManagementConfigModule> {\n    return {\n      ngModule: SettingManagementConfigModule,\n      providers: [SETTING_MANAGEMENT_ROUTE_PROVIDERS, SETTING_MANAGEMENT_SETTING_TAB_PROVIDERS],\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {SETTING_MANAGEMENT_ROUTE_PROVIDERS as ɵb,configureRoutes as ɵc,hideRoutes as ɵd} from './providers/route.provider';\nexport {SETTING_MANAGEMENT_SETTING_TAB_PROVIDERS as ɵe,configureSettingTabs as ɵf} from './providers/setting-tab.provider';\nexport {EmailSettingsService as ɵa} from './proxy/email-settings.service';"],"names":["APP_INITIALIZER","RoutesService","SettingTabsService","debounceTime","map","Injectable","RestService","Validators","finalize","Component","collapse","FormBuilder","ToasterService","NgModule","CoreModule","NgxValidateCoreModule"],"mappings":"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"}