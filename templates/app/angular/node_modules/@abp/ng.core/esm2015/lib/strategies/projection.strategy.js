import { ApplicationRef, ComponentFactoryResolver, } from '@angular/core';
import { CONTAINER_STRATEGY } from './container.strategy';
import { CONTEXT_STRATEGY } from './context.strategy';
import { DOM_STRATEGY } from './dom.strategy';
export class ProjectionStrategy {
    constructor(content) {
        this.content = content;
    }
}
export class ComponentProjectionStrategy extends ProjectionStrategy {
    constructor(component, containerStrategy, contextStrategy = CONTEXT_STRATEGY.None()) {
        super(component);
        this.containerStrategy = containerStrategy;
        this.contextStrategy = contextStrategy;
    }
    injectContent(injector) {
        this.containerStrategy.prepare();
        const resolver = injector.get(ComponentFactoryResolver);
        const factory = resolver.resolveComponentFactory(this.content);
        const componentRef = this.containerStrategy.containerRef.createComponent(factory, this.containerStrategy.getIndex(), injector);
        this.contextStrategy.setContext(componentRef);
        return componentRef;
    }
}
export class RootComponentProjectionStrategy extends ProjectionStrategy {
    constructor(component, contextStrategy = CONTEXT_STRATEGY.None(), domStrategy = DOM_STRATEGY.AppendToBody()) {
        super(component);
        this.contextStrategy = contextStrategy;
        this.domStrategy = domStrategy;
    }
    injectContent(injector) {
        const appRef = injector.get(ApplicationRef);
        const resolver = injector.get(ComponentFactoryResolver);
        const componentRef = resolver
            .resolveComponentFactory(this.content)
            .create(injector);
        this.contextStrategy.setContext(componentRef);
        appRef.attachView(componentRef.hostView);
        const element = componentRef.hostView.rootNodes[0];
        this.domStrategy.insertElement(element);
        return componentRef;
    }
}
export class TemplateProjectionStrategy extends ProjectionStrategy {
    constructor(templateRef, containerStrategy, contextStrategy = CONTEXT_STRATEGY.None()) {
        super(templateRef);
        this.containerStrategy = containerStrategy;
        this.contextStrategy = contextStrategy;
    }
    injectContent() {
        this.containerStrategy.prepare();
        const embeddedViewRef = this.containerStrategy.containerRef.createEmbeddedView(this.content, this.contextStrategy.context, this.containerStrategy.getIndex());
        embeddedViewRef.detectChanges();
        return embeddedViewRef;
    }
}
export const PROJECTION_STRATEGY = {
    AppendComponentToBody(component, context) {
        return new RootComponentProjectionStrategy(component, context && CONTEXT_STRATEGY.Component(context));
    },
    AppendComponentToContainer(component, containerRef, context) {
        return new ComponentProjectionStrategy(component, CONTAINER_STRATEGY.Append(containerRef), context && CONTEXT_STRATEGY.Component(context));
    },
    AppendTemplateToContainer(templateRef, containerRef, context) {
        return new TemplateProjectionStrategy(templateRef, CONTAINER_STRATEGY.Append(containerRef), context && CONTEXT_STRATEGY.Template(context));
    },
    PrependComponentToContainer(component, containerRef, context) {
        return new ComponentProjectionStrategy(component, CONTAINER_STRATEGY.Prepend(containerRef), context && CONTEXT_STRATEGY.Component(context));
    },
    PrependTemplateToContainer(templateRef, containerRef, context) {
        return new TemplateProjectionStrategy(templateRef, CONTAINER_STRATEGY.Prepend(containerRef), context && CONTEXT_STRATEGY.Template(context));
    },
    ProjectComponentToContainer(component, containerRef, context) {
        return new ComponentProjectionStrategy(component, CONTAINER_STRATEGY.Clear(containerRef), context && CONTEXT_STRATEGY.Component(context));
    },
    ProjectTemplateToContainer(templateRef, containerRef, context) {
        return new TemplateProjectionStrategy(templateRef, CONTAINER_STRATEGY.Clear(containerRef), context && CONTEXT_STRATEGY.Template(context));
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvamVjdGlvbi5zdHJhdGVneS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL2NvcmUvc3JjL2xpYi9zdHJhdGVnaWVzL3Byb2plY3Rpb24uc3RyYXRlZ3kudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLGNBQWMsRUFDZCx3QkFBd0IsR0FPekIsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFxQixrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzdFLE9BQU8sRUFBbUIsZ0JBQWdCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUN2RSxPQUFPLEVBQWUsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFM0QsTUFBTSxPQUFnQixrQkFBa0I7SUFDdEMsWUFBbUIsT0FBVTtRQUFWLFlBQU8sR0FBUCxPQUFPLENBQUc7SUFBRyxDQUFDO0NBR2xDO0FBRUQsTUFBTSxPQUFPLDJCQUFpRCxTQUFRLGtCQUFxQjtJQUN6RixZQUNFLFNBQVksRUFDSixpQkFBb0MsRUFDcEMsa0JBQW1DLGdCQUFnQixDQUFDLElBQUksRUFBRTtRQUVsRSxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7UUFIVCxzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO1FBQ3BDLG9CQUFlLEdBQWYsZUFBZSxDQUEyQztJQUdwRSxDQUFDO0lBRUQsYUFBYSxDQUFDLFFBQWtCO1FBQzlCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUVqQyxNQUFNLFFBQVEsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLHdCQUF3QixDQUE2QixDQUFDO1FBQ3BGLE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBd0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXRGLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUN0RSxPQUFPLEVB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Q3ZDLE9BQU8sSUFBSSxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQzlDLENBQUM7SUFDSixDQUFDO0lBQ0QsMkJBQTJCLENBQ3pCLFNBQVksRUFDWixZQUE4QixFQUM5QixPQUF3QztRQUV4QyxPQUFPLElBQUksMkJBQTJCLENBQ3BDLFNBQVMsRUFDVCxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEVBQ3hDLE9BQU8sSUFBSSxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQy9DLENBQUM7SUFDSixDQUFDO0lBQ0QsMEJBQTBCLENBQ3hCLFdBQWMsRUFDZCxZQUE4QixFQUM5QixPQUF1QztRQUV2QyxPQUFPLElBQUksMEJBQTBCLENBQ25DLFdBQVcsRUFDWCxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLEVBQ3hDLE9BQU8sSUFBSSxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQzlDLENBQUM7SUFDSixDQUFDO0lBQ0QsMkJBQTJCLENBQ3pCLFNBQVksRUFDWixZQUE4QixFQUM5QixPQUF3QztRQUV4QyxPQUFPLElBQUksMkJBQTJCLENBQ3BDLFNBQVMsRUFDVCxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLEVBQ3RDLE9BQU8sSUFBSSxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQy9DLENBQUM7SUFDSixDQUFDO0lBQ0QsMEJBQTBCLENBQ3hCLFdBQWMsRUFDZCxZQUE4QixFQUM5QixPQUF1QztRQUV2QyxPQUFPLElBQUksMEJBQTBCLENBQ25DLFdBQVcsRUFDWCxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLEVBQ3RDLE9BQU8sSUFBSSxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQzlDLENBQUM7SUFDSixDQUFDO0NBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFwcGxpY2F0aW9uUmVmLFxuICBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gIENvbXBvbmVudFJlZixcbiAgRW1iZWRkZWRWaWV3UmVmLFxuICBJbmplY3RvcixcbiAgVGVtcGxhdGVSZWYsXG4gIFR5cGUsXG4gIFZpZXdDb250YWluZXJSZWYsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSW5mZXJyZWRDb250ZXh0T2YsIEluZmVycmVkSW5zdGFuY2VPZiB9IGZyb20gJy4uL21vZGVscy91dGlsaXR5JztcbmltcG9ydCB7IENvbnRhaW5lclN0cmF0ZWd5LCBDT05UQUlORVJfU1RSQVRFR1kgfSBmcm9tICcuL2NvbnRhaW5lci5zdHJhdGVneSc7XG5pbXBvcnQgeyBDb250ZXh0U3RyYXRlZ3ksIENPTlRFWFRfU1RSQVRFR1kgfSBmcm9tICcuL2NvbnRleHQuc3RyYXRlZ3knO1xuaW1wb3J0IHsgRG9tU3RyYXRlZ3ksIERPTV9TVFJBVEVHWSB9IGZyb20gJy4vZG9tLnN0cmF0ZWd5JztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFByb2plY3Rpb25TdHJhdGVneTxUID0gYW55PiB7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBjb250ZW50OiBUKSB7fVxuXG4gIGFic3RyYWN0IGluamVjdENvbnRlbnQoaW5qZWN0b3I6IEluamVjdG9yKTogQ29tcG9uZW50UmVmT3JFbWJlZGRlZFZpZXdSZWY8VD47XG59XG5cbmV4cG9ydCBjbGFzcyBDb21wb25lbnRQcm9qZWN0aW9uU3RyYXRlZ3k8VCBleHRlbmRzIFR5cGU8YW55Pj4gZXh0ZW5kcyBQcm9qZWN0aW9uU3RyYXRlZ3k8VD4ge1xuICBjb25zdHJ1Y3RvcihcbiAgICBjb21wb25lbnQ6IFQsXG4gICAgcHJpdmF0ZSBjb250YWluZXJTdHJhdGVneTogQ29udGFpbmVyU3RyYXRlZ3ksXG4gICAgcHJpdmF0ZSBjb250ZXh0U3RyYXRlZ3k6IENvbnRleHRTdHJhdGVneSA9IENPTlRFWFRfU1RSQVRFR1kuTm9uZSgpLFxuICApIHtcbiAgICBzdXBlcihjb21wb25lbnQpO1xuICB9XG5cbiAgaW5qZWN0Q29udGVudChpbmplY3RvcjogSW5qZWN0b3IpIHtcbiAgICB0aGlzLmNvbnRhaW5lclN0cmF0ZWd5LnByZXBhcmUoKTtcblxuICAgIGNvbnN0IHJlc29sdmVyID0gaW5qZWN0b3IuZ2V0KENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcikgYXMgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyO1xuICAgIGNvbnN0IGZhY3RvcnkgPSByZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeTxJbmZlcnJlZEluc3RhbmNlT2Y8VD4+KHRoaXMuY29udGVudCk7XG5cbiAgICBjb25zdCBjb21wb25lbnRSZWYgPSB0aGlzLmNvbnRhaW5lclN0cmF0ZWd5LmNvbnRhaW5lclJlZi5jcmVhdGVDb21wb25lbnQoXG4gICAgICBmYWN0b3J5LFxuICAgICAgdGhpcy5jb250YWluZXJTdHJhdGVneS5nZXRJbmRleCgpLFxuICAgICAgaW5qZWN0b3IsXG4gICAgKTtcbiAgICB0aGlzLmNvbnRleHRTdHJhdGVneS5zZXRDb250ZXh0KGNvbXBvbmVudFJlZik7XG5cbiAgICByZXR1cm4gY29tcG9uZW50UmVmIGFzIENvbXBvbmVudFJlZk9yRW1iZWRkZWRWaWV3UmVmPFQ+O1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSb290Q29tcG9uZW50UHJvamVjdGlvblN0cmF0ZWd5PFQgZXh0ZW5kcyBUeXBlPGFueT4+IGV4dGVuZHMgUHJvamVjdGlvblN0cmF0ZWd5PFQ+IHtcbiAgY29uc3RydWN0b3IoXG4gICAgY29tcG9uZW50OiBULFxuICAgIHByaXZhdGUgY29udGV4dFN0cmF0ZWd5OiBDb250ZXh0U3RyYXRlZ3kgPSBDT05URVhUX1NUUkFURUdZLk5vbmUoKSxcbiAgICBwcml2YXRlIGRvbVN0cmF0ZWd5OiBEb21TdHJhdGVneSA9IERPTV9TVFJBVEVHWS5BcHBlbmRUb0JvZHkoKSxcbiAgKSB7XG4gICAgc3VwZXIoY29tcG9uZW50KTtcbiAgfVxuXG4gIGluamVjdENvbnRlbnQoaW5qZWN0b3I6IEluamVjdG9yKSB7XG4gICAgY29uc3QgYXBwUmVmID0gaW5qZWN0b3IuZ2V0KEFwcGxpY2F0aW9uUmVmKTtcbiAgICBjb25zdCByZXNvbHZlciA9IGluamVjdG9yLmdldChDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIpIGFzIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcjtcbiAgICBjb25zdCBjb21wb25lbnRSZWYgPSByZXNvbHZlclxuICAgICAgLnJlc29sdmVDb21wb25lbnRGYWN0b3J5PEluZmVycmVkSW5zdGFuY2VPZjxUPj4odGhpcy5jb250ZW50KVxuICAgICAgLmNyZWF0ZShpbmplY3Rvcik7XG5cbiAgICB0aGlzLmNvbnRleHRTdHJhdGVneS5zZXRDb250ZXh0KGNvbXBvbmVudFJlZik7XG5cbiAgICBhcHBSZWYuYXR0YWNoVmlldyhjb21wb25lbnRSZWYuaG9zdFZpZXcpO1xuICAgIGNvbnN0IGVsZW1lbnQ6IEhUTUxFbGVtZW50ID0gKGNvbXBvbmVudFJlZi5ob3N0VmlldyBhcyBFbWJlZGRlZFZpZXdSZWY8YW55Pikucm9vdE5vZGVzWzBdO1xuICAgIHRoaXMuZG9tU3RyYXRlZ3kuaW5zZXJ0RWxlbWVudChlbGVtZW50KTtcblxuICAgIHJldHVybiBjb21wb25lbnRSZWYgYXMgQ29tcG9uZW50UmVmT3JFbWJlZGRlZFZpZXdSZWY8VD47XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRlbXBsYXRlUHJvamVjdGlvblN0cmF0ZWd5PFQgZXh0ZW5kcyBUZW1wbGF0ZVJlZjxhbnk+PiBleHRlbmRzIFByb2plY3Rpb25TdHJhdGVneTxUPiB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHRlbXBsYXRlUmVmOiBULFxuICAgIHByaXZhdGUgY29udGFpbmVyU3RyYXRlZ3k6IENvbnRhaW5lclN0cmF0ZWd5LFxuICAgIHByaXZhdGUgY29udGV4dFN0cmF0ZWd5ID0gQ09OVEVYVF9TVFJBVEVHWS5Ob25lKCksXG4gICkge1xuICAgIHN1cGVyKHRlbXBsYXRlUmVmKTtcbiAgfVxuXG4gIGluamVjdENvbnRlbnQoKSB7XG4gICAgdGhpcy5jb250YWluZXJTdHJhdGVneS5wcmVwYXJlKCk7XG5cbiAgICBjb25zdCBlbWJlZGRlZFZpZXdSZWYgPSB0aGlzLmNvbnRhaW5lclN0cmF0ZWd5LmNvbnRhaW5lclJlZi5jcmVhdGVFbWJlZGRlZFZpZXcoXG4gICAgICB0aGlzLmNvbnRlbnQsXG4gICAgICB0aGlzLmNvbnRleHRTdHJhdGVneS5jb250ZXh0LFxuICAgICAgdGhpcy5jb250YWluZXJTdHJhdGVneS5nZXRJbmRleCgpLFxuICAgICk7XG4gICAgZW1iZWRkZWRWaWV3UmVmLmRldGVjdENoYW5nZXMoKTtcblxuICAgIHJldHVybiBlbWJlZGRlZFZpZXdSZWYgYXMgQ29tcG9uZW50UmVmT3JFbWJlZGRlZFZpZXdSZWY8VD47XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IFBST0pFQ1RJT05fU1RSQVRFR1kgPSB7XG4gIEFwcGVuZENvbXBvbmVudFRvQm9keTxUIGV4dGVuZHMgVHlwZTx1bmtub3duPj4oXG4gICAgY29tcG9uZW50OiBULFxuICAgIGNvbnRleHQ/OiBQYXJ0aWFsPEluZmVycmVkSW5zdGFuY2VPZjxUPj4sXG4gICkge1xuICAgIHJldHVybiBuZXcgUm9vdENvbXBvbmVudFByb2plY3Rpb25TdHJhdGVneTxUPihcbiAgICAgIGNvbXBvbmVudCxcbiAgICAgIGNvbnRleHQgJiYgQ09OVEVYVF9TVFJBVEVHWS5Db21wb25lbnQoY29udGV4dCksXG4gICAgKTtcbiAgfSxcbiAgQXBwZW5kQ29tcG9uZW50VG9Db250YWluZXI8VCBleHRlbmRzIFR5cGU8dW5rbm93bj4+KFxuICAgIGNvbXBvbmVudDogVCxcbiAgICBjb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYsXG4gICAgY29udGV4dD86IFBhcnRpYWw8SW5mZXJyZWRJbnN0YW5jZU9mPFQ+PixcbiAgKSB7XG4gICAgcmV0dXJuIG5ldyBDb21wb25lbnRQcm9qZWN0aW9uU3RyYXRlZ3k8VD4oXG4gICAgICBjb21wb25lbnQsXG4gICAgICBDT05UQUlORVJfU1RSQVRFR1kuQXBwZW5kKGNvbnRhaW5lclJlZiksXG4gICAgICBjb250ZXh0ICYmIENPTlRFWFRfU1RSQVRFR1kuQ29tcG9uZW50KGNvbnRleHQpLFxuICAgICk7XG4gIH0sXG4gIEFwcGVuZFRlbXBsYXRlVG9Db250YWluZXI8VCBleHRlbmRzIFRlbXBsYXRlUmVmPHVua25vd24+PihcbiAgICB0ZW1wbGF0ZVJlZjogVCxcbiAgICBjb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYsXG4gICAgY29udGV4dD86IFBhcnRpYWw8SW5mZXJyZWRDb250ZXh0T2Y8VD4+LFxuICApIHtcbiAgICByZXR1cm4gbmV3IFRlbXBsYXRlUHJvamVjdGlvblN0cmF0ZWd5PFQ+KFxuICAgICAgdGVtcGxhdGVSZWYsXG4gICAgICBDT05UQUlORVJfU1RSQVRFR1kuQXBwZW5kKGNvbnRhaW5lclJlZiksXG4gICAgICBjb250ZXh0ICYmIENPTlRFWFRfU1RSQVRFR1kuVGVtcGxhdGUoY29udGV4dCksXG4gICAgKTtcbiAgfSxcbiAgUHJlcGVuZENvbXBvbmVudFRvQ29udGFpbmVyPFQgZXh0ZW5kcyBUeXBlPHVua25vd24+PihcbiAgICBjb21wb25lbnQ6IFQsXG4gICAgY29udGFpbmVyUmVmOiBWaWV3Q29udGFpbmVyUmVmLFxuICAgIGNvbnRleHQ/OiBQYXJ0aWFsPEluZmVycmVkSW5zdGFuY2VPZjxUPj4sXG4gICkge1xuICAgIHJldHVybiBuZXcgQ29tcG9uZW50UHJvamVjdGlvblN0cmF0ZWd5PFQ+KFxuICAgICAgY29tcG9uZW50LFxuICAgICAgQ09OVEFJTkVSX1NUUkFURUdZLlByZXBlbmQoY29udGFpbmVyUmVmKSxcbiAgICAgIGNvbnRleHQgJiYgQ09OVEVYVF9TVFJBVEVHWS5Db21wb25lbnQoY29udGV4dCksXG4gICAgKTtcbiAgfSxcbiAgUHJlcGVuZFRlbXBsYXRlVG9Db250YWluZXI8VCBleHRlbmRzIFRlbXBsYXRlUmVmPHVua25vd24+PihcbiAgICB0ZW1wbGF0ZVJlZjogVCxcbiAgICBjb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYsXG4gICAgY29udGV4dD86IFBhcnRpYWw8SW5mZXJyZWRDb250ZXh0T2Y8VD4+LFxuICApIHtcbiAgICByZXR1cm4gbmV3IFRlbXBsYXRlUHJvamVjdGlvblN0cmF0ZWd5PFQ+KFxuICAgICAgdGVtcGxhdGVSZWYsXG4gICAgICBDT05UQUlORVJfU1RSQVRFR1kuUHJlcGVuZChjb250YWluZXJSZWYpLFxuICAgICAgY29udGV4dCAmJiBDT05URVhUX1NUUkFURUdZLlRlbXBsYXRlKGNvbnRleHQpLFxuICAgICk7XG4gIH0sXG4gIFByb2plY3RDb21wb25lbnRUb0NvbnRhaW5lcjxUIGV4dGVuZHMgVHlwZTx1bmtub3duPj4oXG4gICAgY29tcG9uZW50OiBULFxuICAgIGNvbnRhaW5lclJlZjogVmlld0NvbnRhaW5lclJlZixcbiAgICBjb250ZXh0PzogUGFydGlhbDxJbmZlcnJlZEluc3RhbmNlT2Y8VD4+LFxuICApIHtcbiAgICByZXR1cm4gbmV3IENvbXBvbmVudFByb2plY3Rpb25TdHJhdGVneTxUPihcbiAgICAgIGNvbXBvbmVudCxcbiAgICAgIENPTlRBSU5FUl9TVFJBVEVHWS5DbGVhcihjb250YWluZXJSZWYpLFxuICAgICAgY29udGV4dCAmJiBDT05URVhUX1NUUkFURUdZLkNvbXBvbmVudChjb250ZXh0KSxcbiAgICApO1xuICB9LFxuICBQcm9qZWN0VGVtcGxhdGVUb0NvbnRhaW5lcjxUIGV4dGVuZHMgVGVtcGxhdGVSZWY8dW5rbm93bj4+KFxuICAgIHRlbXBsYXRlUmVmOiBULFxuICAgIGNvbnRhaW5lclJlZjogVmlld0NvbnRhaW5lclJlZixcbiAgICBjb250ZXh0PzogUGFydGlhbDxJbmZlcnJlZENvbnRleHRPZjxUPj4sXG4gICkge1xuICAgIHJldHVybiBuZXcgVGVtcGxhdGVQcm9qZWN0aW9uU3RyYXRlZ3k8VD4oXG4gICAgICB0ZW1wbGF0ZVJlZixcbiAgICAgIENPTlRBSU5FUl9TVFJBVEVHWS5DbGVhcihjb250YWluZXJSZWYpLFxuICAgICAgY29udGV4dCAmJiBDT05URVhUX1NUUkFURUdZLlRlbXBsYXRlKGNvbnRleHQpLFxuICAgICk7XG4gIH0sXG59O1xuXG50eXBlIENvbXBvbmVudFJlZk9yRW1iZWRkZWRWaWV3UmVmPFQ+ID0gVCBleHRlbmRzIFR5cGU8aW5mZXIgVT5cbiAgPyBDb21wb25lbnRSZWY8VT5cbiAgOiBUIGV4dGVuZHMgVGVtcGxhdGVSZWY8aW5mZXIgQz5cbiAgPyBFbWJlZGRlZFZpZXdSZWY8Qz5cbiAgOiBuZXZlcjtcbiJdfQ==